{% extends "base.html" %}

{% block content %}
<div class="min-h-screen grid-bg pt-20 pb-12">
    <div class="max-w-4xl mx-auto px-6">
        <div class="text-center mb-12">
            <div
                class="inline-block px-3 py-1 mb-6 text-xs font-mono text-emerald-500/80 border border-emerald-500/30 rounded bg-emerald-500/5">
                ðŸ§© FREE TOOL
            </div>
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-6">
                Shamir's Playground
            </h1>
            <p class="text-xl text-zinc-400">
                Visualize the math behind deadhand. Split any secret into parts right in your browser.
            </p>
        </div>

        <!-- The Playground -->
        <div class="border-gradient rounded-xl p-8 bg-zinc-900/50 mb-12">

            <!-- Splitter -->
            <div class="mb-12">
                <h3 class="text-xl font-bold text-white mb-4">1. Split a Secret</h3>
                <div class="space-y-4">
                    <input type="text" id="secretInput" placeholder="Enter a secret text or number..."
                        class="w-full bg-black/50 border border-zinc-700 rounded-lg px-4 py-3 text-white focus:border-emerald-500 focus:outline-none transition font-mono">

                    <button onclick="splitSecret()"
                        class="px-6 py-3 bg-zinc-800 hover:bg-zinc-700 text-white font-medium rounded-lg transition border border-zinc-700">
                        Split into 3 shards (2 needed)
                    </button>

                    <div id="shardsOutput" class="hidden space-y-2 mt-4">
                        <div class="p-3 bg-black/30 rounded border border-zinc-800 font-mono text-xs text-emerald-400 break-all"
                            id="shard1"></div>
                        <div class="p-3 bg-black/30 rounded border border-zinc-800 font-mono text-xs text-emerald-400 break-all"
                            id="shard2"></div>
                        <div class="p-3 bg-black/30 rounded border border-zinc-800 font-mono text-xs text-emerald-400 break-all"
                            id="shard3"></div>
                    </div>
                </div>
            </div>

            <div class="border-t border-zinc-800 my-8"></div>

            <!-- Combiner -->
            <div>
                <h3 class="text-xl font-bold text-white mb-4">2. Reconstruct</h3>
                <p class="text-sm text-zinc-500 mb-4">Paste any 2 shards from above to recover the secret.</p>

                <div class="space-y-4">
                    <input type="text" id="recShard1" placeholder="Paste Shard A"
                        class="w-full bg-black/50 border border-zinc-700 rounded-lg px-4 py-3 text-white focus:border-emerald-500 focus:outline-none transition font-mono text-xs">
                    <input type="text" id="recShard2" placeholder="Paste Shard B"
                        class="w-full bg-black/50 border border-zinc-700 rounded-lg px-4 py-3 text-white focus:border-emerald-500 focus:outline-none transition font-mono text-xs">

                    <button onclick="combineShards()"
                        class="px-6 py-3 bg-emerald-600 hover:bg-emerald-500 text-black font-bold rounded-lg transition">
                        Reconstruct Secret
                    </button>

                    <div id="reconstructedOutput"
                        class="hidden mt-4 p-4 bg-emerald-500/10 border border-emerald-500/30 rounded-lg text-white font-mono break-all text-center text-lg">
                    </div>
                </div>
            </div>
        </div>

        <!-- The Upsell -->
        <div class="border border-accent/20 bg-accent/5 rounded-lg p-6 text-center mb-12">
            <h3 class="text-xl font-bold text-white mb-2">Cool math, right?</h3>
            <p class="text-zinc-400 mb-6">
                Now imagine doing this manually for a high-stakes seed phrase. <br>
                Let us handle the infrastructure, backups, and inheritance.
            </p>
            <a href="/app?plan=lifetime"
                class="inline-block px-8 py-3 bg-accent text-black font-bold rounded hover:bg-emerald-400 transition">
                Get the Professional Version ($129)
            </a>
        </div>

        <!-- SEO Content -->
        <div class="prose prose-invert max-w-none text-zinc-400">
            <h2>About Shamir's Secret Sharing</h2>
            <p>
                Shamir's Secret Sharing (SSSS) is an algorithm developed by Adi Shamir in 1979. It divides a secret into
                unique parts (shards), where some subset of those parts is needed to reconstruct the secret.
            </p>
            <p>
                The math relies on polynomial interpolation. To create a (k, n) threshold scheme, we construct a
                polynomial of degree k-1.
                deadhand uses this exact mathematics to secure your crypto inheritance.
            </p>
        </div>
    </div>
</div>

<script>
    function splitSecret() {
        const secret = document.getElementById('secretInput').value;
        if (!secret) return;

        // Convert string to hex
        const secretHex = secrets.str2hex(secret);

        // Split into 3 shares, threshold 2
        const shares = secrets.share(secretHex, 3, 2);

        document.getElementById('shard1').innerText = shares[0];
        document.getElementById('shard2').innerText = shares[1];
        document.getElementById('shard3').innerText = shares[2];

        document.getElementById('shardsOutput').classList.remove('hidden');
    }

    function combineShards() {
        const s1 = document.getElementById('recShard1').value.trim();
        const s2 = document.getElementById('recShard2').value.trim();

        if (!s1 || !s2) {
            alert("Please enter two shards");
            return;
        }

        try {
            const hex = secrets.combine([s1, s2]);
            const str = secrets.hex2str(hex);

            const out = document.getElementById('reconstructedOutput');
            out.innerText = str;
            out.classList.remove('hidden');
        } catch (e) {
            alert("Could not reconstruct. Invalid shards.");
        }
    }
</script>
{% endblock %}